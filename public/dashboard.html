<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tableau de Bord des Templates</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/htmx.org@1.9.6"></script>
    <script>
        if (document.cookie.indexOf('supabase-auth-token') === -1 && window.location.pathname !== '/install.html') {
            window.location.href = '/login';
        }
    </script>
</head>
<body class="bg-gray-100 p-8">
    <header class="mb-6">
        <h1 class="text-3xl font-bold text-gray-800">Tableau de Bord des Templates</h1>
    </header>
    <main>
        <div id="templates-list" hx-get="/get-templates" hx-trigger="load" class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
            <template id="template-item">
                <div class="bg-white rounded-md shadow-md p-4">
                    <h2 class="text-xl font-semibold" data-bind="name"></h2>
                    <div class="mt-2 flex justify-between">
                        <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Modifier</button>
                        <button class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded">Dupliquer</button>
                        <button class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">Supprimer</button>
                    </div>
                </div>
            </template>
            <script>
                document.body.addEventListener('htmx:after-swap', function(event) {
                    if (event.target.id === 'templates-list') {
                        const template = document.getElementById('template-item');
                        const list = document.getElementById('templates-list');
                        list.innerHTML = ''; // Clear loading message

                        JSON.parse(event.detail.xhr.response).forEach(item => {
                            const clone = template.content.cloneNode(true);
                            clone.querySelector('[data-bind="name"]').textContent = item.name;
                            list.appendChild(clone);
                        });
                    }
                });
            </script>
        </div>
    </main>
    <script>
        document.body.addEventListener('htmx:after-swap', function(event) {
            console.log('Templates charg√©s.');
        });
    </script>
</body>
</html>
